#! /usr/bin/env nix-shell
#! nix-shell -i zsh

cd ~/.xmonad
# set up the compile flags
[[ -a cabal.project.local ]] && rm cabal.project.local
cabal new-configure --enable-optimisation --enable-library-stripping
  
# build
cabal new-build &&\
  mv -u dist-newstyle/build/x86_64-linux/**/build/xmonad/xmonad xmonad-x86_64-linux ||\
  true

# restart xmonad
xmonad --restart
